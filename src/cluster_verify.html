<!DOCTYPE html>
<html>
<head>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSIEnpgGi6s6cCMrLNSTCglznpu-9g7co"></script> 
</head>
<body>
    <script>
        function addMarker(props, map){
            var marker = new google.maps.Marker({
                position: props.coords,
                map: map,
                //icon: props.iconImage
            });
            
            if(props.iconImage){
                marker.setIcon(props.iconImage);
            }
            
            if(props.content){
                var infoWindow = new google.maps.InfoWindow({
                    content: props.content
                });
                marker.addListener('click', function(){
                    infoWindow.open(mymap, marker);
                });
            }
        } 

        function textTo2DArray(input) {
            input = input.substring(1, input.length - 1);
            const rows = input.split("],[");
            // console.log(rows)

            const array2D = rows.map(row => {
                console.log(typeof(row) + '  ' + row)
                const columns = row.replace("[", "").replace("]", "").split(",");
                // const columns = row.split(",");
                return columns.map(Number);  
            });  
            
            return array2D; 
            }

        function processCoords() {
            const coords = document.getElementById("coords").value; 
            const coordList = textTo2DArray(coords)
            console.log(coordList)
            coordList.forEach( coord => {
                // const coordTuple = coord.substring(1,coord.length -1).split(",").map(c => parseFloat(c.trim()));
                const long = coord[0];
                const lat = coord[1];
                console.log(long + '--' + lat)
                
                const mapDiv = document.createElement("div");
                mapDiv.style.width = "400px";
                mapDiv.style.height = "400px";
                
                document.getElementById("mapContainer").appendChild(mapDiv);  
            
                initMap(long, lat, mapDiv);  
            });
        } 

        function initMap(long, lat, mapDiv) {
            var coords = {lat: lat, lng: long};
            console.log(coords)
        
            var options = {
                zoom: 16,
                center: coords,
                mapTypeId: 'satellite'
            };
        
            var map = new google.maps.Map(mapDiv, options);
        
            var marker = {
                coords:coords,
                iconImage:'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
                content: '<h1>Subway CAN</h1>'
            }
            
            addMarker(marker, map);
        }     
        </script>

    <input type="text" id="coords" placeholder="[[long,lat], [long,lat], ...]">
    <button onclick="processCoords()">Show Maps</button>

    <div id="mapContainer">
    </div>

    <input type="text" id="long1" placeholder="Longitude.."> 
    <input type="text" id="lat1" placeholder="Latitude.."><br>
    
    <button onclick="initMap()">Show Map 1</button>
    
    <div id="map1" style="width:80%;height:500px;"></div>

</body> 
</html>